<!DOCTYPE html>
<html>

<head>
  <title>高校实验室管理平台 </title>
  <meta name="keywords" content="高校实验室管理平台" />
  <meta name="description" content="高校实验室管理平台" />
  <meta charset="utf-8">
  <meta name="view-port">
  <meta name="viewport" content="width=device-width, initial-scale=1.0,maximum-scale=1.0, user-scalable=0">
  <meta http-equiv="X-UA-Compatible" content="ie=edge">
  <link rel="stylesheet" href="../../assets/css/u-reset.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@3.3.7/dist/css/bootstrap.min.css"
    integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
  <link rel="stylesheet" href="../../assets/css/layui.css">
  <link rel="stylesheet" href="../../assets/css/login.css">
  <link rel="stylesheet" href="http://at.alicdn.com/t/font_1842343_yukudkn3aw.css">
  <link rel="stylesheet" href="../../assets/css/device.css">
  <link rel="icon" href="../../assets/images/icon.png">
  <script src="../../assets/js/jQuery/jquery-3.4.1.js"></script>
  <script src="../../assets/js/table.js"></script>
  <script src="https://cdn.bootcss.com/echarts/4.7.0/echarts.min.js"></script>
  <!-- <script src="https://www.echartsjs.com/examples/vendors/echarts-gl/echarts-gl.js"></script> -->
  <!-- <script src="./js/jquery-3.4.1.js"></script> -->
  <script src="../../assets/js/deviceecharts.js"></script>
  <!-- 最新版本的 Bootstrap 核心 CSS 文件 -->
  <style>
    body {
      background-color: #fff;
    }

    #app {
      padding: 2%;
      /* font-family: '华文新魏'; */
    }

    .layui-layout-body {
      overflow: auto;
    }

    .echarts {
      padding: 2%;
      width: 100%;
      height: 500px;

    }

    .layui-row {
      margin-bottom: 0;
    }
  </style>
</head>

<body>
  <div class="layui-layout layui-layout-admin">
    <div class="layui-header">
      <a href="../../index.html">
        <div class="layui-logo">
          <img src="../../assets/images/logo.png" alt="">
          高校实验室管理平台
        </div>
      </a>
      <ul class="layui-col-md7 layui-hide-xs  layui-nav layui-layout-left" style="margin-left:20%;">
        <li class="layui-nav-item">
            <a href="javascript:;">设备</a>
            <dl class="layui-nav-child">
                <dd><a href="../device/device.html">设备信息查看</a></dd>
                <dd><a href="../device/labInformation.html">项目信息</a></dd>
                <dd><a href="../device/monitaring.html">实验状态监控</a></dd>
                <dd><a href="../device/deviceInformation.html">智能分析</a></dd>
            </dl>
        </li>
        <li class="layui-nav-item">
            <a href="javascript:;">耗材</a>
            <dl class="layui-nav-child">
                <dd><a href="../consume/consume_inform.html">基本资料</a></dd>
                <dd><a href="../consume/consume_storage.html">申请购置</a></dd>
                <dd><a href="../consume/consume-custudy.html">保管领用</a></dd>
                <dd><a href="../consume/consume-norm.html">管理标准</a></dd>
            </dl>
        </li>
        <li class="layui-nav-item">
            <a href="javascript:;">预约</a>
            <dl class="layui-nav-child">
                <dd><a href="../arrange/arrange-page.html">预约安排</a></dd>

            </dl>
        </li>
        <li class="layui-nav-item">
            <a href="javascript:;">项目</a>
            <dl class="layui-nav-child">
                <dd><a href="../project/project-science.html">实验项目</a></dd>
                <dd><a href="javascript:;">教学资源</a></dd>
            </dl>
        </li>
        <li class="layui-nav-item">
            <a href="javascript:;">系统</a>
            <dl class="layui-nav-child">
                <dd><a href="javascript:;">用户信息</a></dd>
                <dd><a href="./system-password.html">密码修改</a></dd>
            </dl>
        </li>
    </ul>

      <ul class="layui-nav layui-layout-right">
        <li class="layui-nav-item layui-hide-sm layui-show-xs-inline-block"><i class="iconfont icon-caidan1"></i></li>
        <li class="layui-nav-item"><a href="../../index.html"><i class="iconfont icon-shouye"></i>主页</a></li>
        <li class="layui-nav-item"><a href="../../login.html">退出</a></li>
      </ul>
    </div>
    <div class="layui-row">
      <div class="layui-col-md4">
        <div class="echarts"></div>
      </div>
      <div class="layui-col-md8">
        <div id="app">

          <div class="layui-form">


            <!--  <button type="button" class="layui-btn  layui-btn-normal" style="float: right" lay-submit lay-filter="formDemo">
        <i class="layui-icon">&#xe60a;</i> 生成报表
    </button> -->
            <!-- <table class="table table-hover" style="height: 350px;"> -->
            <table class="table table-striped table-hover">
              <thead>
                <tr v-if="headdata.length">
                  <th v-for="item in headdata">{{item.names}}</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>1</td>
                  <td>服务器</td>
                  <td>联想万全R520(Xeon563)</td>
                  <td>1</td>
                  <td>401</td>
                  <td>118815224</td>
                  <td>2010-11-11</td>
                  <td>15825874111</td>
                  <td>15825874111</td>
                </tr>
              </tbody>
            </table>
            <div class="table-bottom">
              <button type="button" lay-submit="" class="layui-btn d" id="exportExcel" name="exportExcel">
                <i class="layui-icon"></i>导出实验室设备信息报告</button>

              <nav aria-label="Page navigation">
                <ul class="pagination">
                  <li class="disabled" style="display: none;">
                    <span>
                      <span aria-hidden="true">&laquo;</span>
                    </span>
                  </li>
                  <li><a href="#">1</a></li>
                  <li><a href="#">2</a></li>
                  <li><a href="#">3</a></li>
                  <li><a href="#">4</a></li>
                  <li><a href="#">5</a></li>
                  <li style="display: none;">
                    <a href="#" aria-label="Next">
                      <span aria-hidden="true">&raquo;</span>
                    </a>
                  </li>
                </ul>
              </nav>
            </div>
            <!-- <div class="echarts"></div> -->
          </div>

        </div>
      </div>

    </div>
  </div>
  <script src="../../assets/js/vue/vue.js"></script>
  <script src="../../assets/js/layui_exts/layui.all.js"></script>
  <!--先加载jquery-->
  <!-- <script src="./js/jquery-3.4.1.js"></script> -->
  <!--再加载插件-->
  <script src="../../assets/js/layui_exts/excel.js"></script>
  <script>
    //JavaScript代码区域
    layui.use(['element'], function () {
      var element = layui.element;
    });
  </script>
  <script>
    let vm = new Vue({
      el: '#app',
      data: {
        
        headdata: [
          { id: 1, names: '设备编号' },
          { id: 3, names: '设备名称' },
          { id: 4, names: '品牌型号' },
          { id: 5, names: '设备状态' },
          { id: 6, names: '设备数量' },
          { id: 7, names: '实验室名称' },
          /*    { id: 8, names: '出厂编号' },
             { id: 9, names: '出厂日期' },
             { id: 10, names: '生产厂商编号' },
             { id: 11, names: '供应商编号' }, */
          // { id: 12, names: '操作' },
        ],
        devicedata: [
          {
            id: 1,
            names: '精密ph计',
            brand: '柯迪达CT-6021A',
            conid: '已使用',
            num: '40',
            roomnames: '化学实验室',
            facid: 'RG78201912129',
            factime: '2019-12-12',
            proid: '78576',
            supid: '1209752',
            uratio: '23%',
            arate: '13%'
          },

          {
            id: 2,
            names: '数字贝克曼温度计',
            brand: '希玛AT-380',
            conid: '已使用',
            num: '10',
            roomnames: '化工材料室',
            facid: 'RG45202003178',
            factime: '2020-03-17',
            proid: '45353',
            supid: '1108533',
            uratio: '4%',
            arate: '1%'
          },
          {
            id: 3,
            names: '玻璃器皿',
            brand: ' 信蓝铭',
            conid: '已使用',
            num: '50',
            roomnames: '化学实验室',
            facid: 'LY85201702068',
            factime: '2017-02-06',
            proid: '16593',
            supid: '1305489',
            uratio: '72%',
            arate: '63%'
          },
          {
            id: 4,
            names: '药品柜',
            brand: '知旦药品柜',
            conid: '已使用',
            num: '1',
            roomnames: '化工材料室',
            facid: 'GR89201806085',
            factime: '2018-06-08',
            proid: '79263',
            supid: '1009463',
            uratio: '47%',
            arate: '42%'
          },

          {
            id: 5,
            names: '三联水嘴',
            brand: ' 迪尔',
            conid: '已使用',
            num: '20',
            roomnames: '化学实验室',
            facid: 'DG58201907297',
            factime: '2019-07-29',
            proid: '84511',
            supid: '1207725',
            uratio: '44%',
            arate: '35%'
          },
          {
            id: 6,
            names: '器皿柜',
            brand: ' 菲可帝睿',
            conid: '已使用',
            num: '1',
            roomnames: '化工材料室',
            facid: 'QM15201809155',
            factime: '2018-09-15',
            proid: '48152',
            supid: '1108158',
            uratio: '45%',
            arate: '35%'
          },

          {
            id: 7,
            names: '实验室玻璃干燥器',
            brand: '丫米',
            conid: '已使用',
            num: '30',
            roomnames: '化学实验室',
            facid: 'HB18201904209',
            factime: '2019-04-20',
            proid: '18151',
            supid: '11061565',
            uratio: '20%',
            arate: '13%'
          },

          {
            id: 8,
            names: '马弗炉',
            brand: '艾帝威',
            conid: '已使用',
            num: '5',
            roomnames: '化学实验室',
            facid: 'MY15201912289',
            factime: '2019-12-28',
            proid: '18521',
            supid: '1001241',
            uratio: '30%',
            arate: '24%'
          },

          {
            id: 9,
            names: '离心机',
            brand: '力辰科技（lichen）',
            conid: '已使用',
            num: '2',
            roomnames: '化学实验室',
            facid: 'SW15201705279',
            factime: '2017-05-27',
            proid: '78126',
            supid: '1209831',
            uratio: '55%',
            arate: '50%'
          },
          {
            id: 10,
            names: '分光光度计',
            brand: '中实仪',
            conid: '已使用',
            num: '10',
            roomnames: '化学实验室',
            facid: 'FR24201912261',
            factime: '2019-12-26',
            proid: '15481',
            supid: '1004159',
            uratio: '4%',
            arate: '1%'
          },
          {
            id: 11,
            names: '电热数显恒温水浴锅',
            brand: ' JOAN LAB',
            conid: '已使用',
            num: '30',
            roomnames: '化学实验室',
            facid: 'CO02201910261',
            factime: '2019-10-26',
            proid: '12889',
            supid: '1103030',
            uratio: '20%',
            arate: '6%'
          },
          {
            id: 12,
            names: '精密数字压力计',
            brand: 'AZAZ8215',
            conid: '已使用',
            num: '30',
            roomnames: '化工实验室',
            facid: 'YS45202003277',
            factime: '2020-03-27',
            proid: '15453',
            supid: '1007753',
            uratio: '10%',
            arate: '6%'
          },

          {
            id: 13,
            names: '化验水槽',
            brand: '言竹',
            conid: '已使用',
            num: '30',
            roomnames: '化学实验室',
            facid: 'TH82201712088',
            factime: '2017-12-08',
            proid: '81545',
            supid: '1405148',
            uratio: '65%',
            arate: '50%'
          },

          {
            id: 14,
            names: '智能试剂柜',
            brand: ' 洛克菲勒（LUO KE FEI LE）',
            conid: '已使用',
            num: '1',
            roomnames: '化工材料室',
            facid: 'HC02201907038',
            factime: '2019-07-03',
            proid: '78526',
            supid: '1206989',
            uratio: '8%',
            arate: '5%'
          },

          {
            id: 15,
            names: '磁力搅拌器',
            brand: ' JOAN LAB',
            conid: '已使用',
            num: '50',
            roomnames: '化学实验室',
            facid: 'AJ58201807208',
            factime: '2018-07-20',
            proid: '79632',
            supid: '1208797',
            uratio: '50%',
            arate: '28%'
          },
          {
            id: 16,
            names: '电位计',
            brand: 'AZAZ8651系列',
            conid: '已使用',
            num: '20',
            roomnames: '化学实验室',
            facid: 'RV48201912098',
            factime: '2019-12-09',
            proid: '48451',
            supid: '1108513',
            uratio: '30%',
            arate: '25%'
          },

          {
            id: 17,
            names: '微波萃取仪',
            brand: ' 新芝·（SCIENTZ）',
            conid: '已使用',
            num: '5',
            roomnames: '化学实验室',
            facid: 'FG41201912288',
            factime: '2019-12-28',
            proid: '18451',
            supid: '0708613',
            uratio: '12%',
            arate: '6%'
          },

          {
            id: 18,
            names: '微波消解仪',
            brand: 'TFNFG30',
            conid: '已使用',
            num: '5',
            roomnames: '化工材料室',
            facid: 'DO15202003164',
            factime: '2020-03-16',
            proid: '84813',
            supid: '1207152',
            uratio: '10%',
            arate: '2%'
          },
          {
            id: 19,
            names: '天平',
            brand: '力辰科技（lichen）',
            conid: '已使用',
            num: '30',
            roomnames: '化学实验室',
            facid: 'LO18201705309',
            factime: '2017-05-30',
            proid: '79623',
            supid: '1101885',
            uratio: '65%',
            arate: '50%'
          },

          {
            id: 20,
            names: '低温恒温槽',
            brand: ' HFXJZ',
            conid: '已使用',
            num: '10',
            roomnames: '化学实验室',
            facid: 'DG18201901268',
            factime: '2019-01-26',
            proid: '18123',
            supid: '1103484',
            uratio: '33%',
            arate: '29%'
          },

           {
             id: 21,
             names: '服务器',
             brand: '戴尔（DELL）Poweredge R740 ',
             conid: '已使用',
             num: '60',
             roomnames: '电商实验室',
             facid: 'CA02201910251',
             factime: '2019-10-25',
             proid: '12689',
             supid: '1003030',
             uratio: '21%',
             arate: '5%'
           },
           {
             id: 22,
             names: '笔记本电脑',
             brand: '华硕（ASUS）PX574',
             conid: '已使用',
             num: '60',
             roomnames: '网络实验室',
             facid: 'BA02201903257',
             factime: '2019-03-25',
             proid: '18685',
             supid: '1105023',
             uratio: '32%',
             arate: '10%'
           },
 
           {
             id: 23,
             names: '标准投影仪',
             brand: '极米Z6',
             conid: '已使用',
             num: '10',
             roomnames: '电商实验室',
             facid: 'AG02201711268',
             factime: '2017-11-26',
             proid: '79026',
             supid: '1011283',
             uratio: '75%',
             arate: '55%'
           },
 
           {
             id: 24,
             names: '交换机',
             brand: '华为（HUAWEI）',
             conid: '已使用',
             num: '30',
             roomnames: '网络实验室',
             facid: 'HN03201908088',
             factime: '2019-08-08',
             proid: '12256',
             supid: '1110368',
             uratio: '25%',
             arate: '8%'
           },
 
           {
             id: 25,
             names: '扫描仪',
             brand: '科密GP1500AF',
             conid: '已使用',
             num: '30',
             roomnames: '会计实验室',
             facid: 'OJ58201809058',
             factime: '2018-09-05',
             proid: '89126',
             supid: '1206797',
             uratio: '34%',
             arate: '24%'
           },
           {
             id: 26,
             names: '发动机拆装常规工具组',
             brand: '如友',
             conid: '已使用',
             num: '10',
             roomnames: '机电实验室',
             facid: 'PK89201705258',
             factime: '2017-05-25',
             proid: '78126',
             supid: '1308168',
             uratio: '57%',
             arate: '45%'
           },
 
           {
             id: 27,
             names: '智能试剂柜',
             brand: ' 洛克菲勒（LUO KE FEI LE）',
             conid: '已使用',
             num: '1',
             roomnames: '化工材料室',
             facid: 'HC02201907038',
             factime: '2019-07-03',
             proid: '78526',
             supid: '1206989',
             uratio: '8%',
             arate: '5%'
           },
 
           {
             id: 28,
             names: '电喷发动机',
             brand: '恒硕通',
             conid: '已使用',
             num: '10',
             roomnames: '汽修实验室',
             facid: 'KL82201803064',
             factime: '2018-03-06',
             proid: '85126',
             supid: '1302589',
             uratio: '67%',
             arate: '36%'
           },
           {
             id: 29,
             names: '离心机',
             brand: '力辰科技（lichen）',
             conid: '已使用',
             num: '2',
             roomnames: '生物实验室',
             facid: 'SW15201705279',
             factime: '2017-05-27',
             proid: '78126',
             supid: '1209831',
             uratio: '55%',
             arate: '50%'
           },
 
           {
             id: 30,
             names: '验钞机',
             brand: '科密B1+',
             conid: '已使用',
             num: '2',
             roomnames: '会计实验室',
             facid: 'KJ25201911268',
             factime: '2019-11-26',
             proid: '58186',
             supid: '1308719',
             uratio: '24%',
             arate: '6%'
           },
        ],

      },
      watch: {
        devicedata: function () {
          this._save();
        },
      },
      methods: {
        initdevicedata() {

          localStorage.setItem('devicedata', JSON.stringify(this.devicedata));

          let devicedata = localStorage.getItem('devicedata');

          if (devicedata) {
            this.devicedata = JSON.parse(devicedata);
          };
        },
        inserttodo() {
          let id = this._lastId();
          //拷贝
          let todo = Object.assign({}, this.todo, { id });

          this.todolist.push(todo);

          this.todo = {
            id: 0,
            title: '',
            ctime: '',
            status: false,
          };

        },
        deletedevicedata(id) {
          this.devicedata = this.devicedata.filter(ele => ele.id != id);

        },
        _lastId() {
          let todolist = this.todolist;
          let id = 2;
          if (todolist.length) {
            id = todolist[todolist.length - 1].id + 1;
          }
          return id;
        },

        _save() {

          let devicedata = JSON.stringify(this.devicedata);

          localStorage.setItem('devicedata', devicedata);
        }
      },
      computed: {
        devicedata1: function () {
          return this.devicedata.slice(0, 6);

        },
        donelength: function () {
          return this.todolist.filter(ele => ele.status).length;
        },
        doinglength: function () {
          return this.todolist.filter(ele => !ele.status).length;
        }

      },
      mounted() {
        this.initdevicedata();
      }
    })

  </script>
  <script>
    layui.config({
      base: '${base}/scripts/layui/layui_exts/'
    }).use(['excel', 'layer'], function () {
      var $ = layui.$;
      var layer = layui.layer;
      var excel = layui.excel;
      $('#exportExcel').on('click', function () {

        var data = JSON.parse(localStorage.getItem('devicedata'));

        /*    console.dir(data);
           console.log(typeof data); */

        // 调用样例
        data = excel.filterExportData(data, [
          'id',
          'names',
          'brand',
          'conid',
          'num',
          'roomnames',
          'facid',
          'factime',
          'proid',
          'supid',
          'uratio',
          'arate'
        ]);

        data.unshift({
          id: "设备编号", names: '设备名称', brand: '品牌型号', conid: '设备状态', num: '设备数量',
          roomnames: '实验室名称', facid: '出厂编号', factime: '出厂日期', proid: '生产厂商编号', supid: '供应商编号',
          uratio: '使用率', arate: '损耗率'
        });
        var colConf = excel.makeColConfig({
          'B': 120, 'C': 180, 'F': 100, 'G': 100, 'H': 80, 'J': 70
        }, 60)

        excel.setRoundBorder(data, 'A1:L31', {
          top: { style: 'thick', color: { rgb: '007751;' } },
          bottom: { style: 'thick', color: { rgb: '007751' } },
          left: { style: 'thick', color: { rgb: '007751' } },
          right: { style: 'thick', color: { rgb: '007751' } },
        })

        var timestart = Date.now();
        excel.exportExcel(data, '实验室设备信息报告' + '.xlsx', 'xlsx', {
          extend: {
            '!cols': colConf
          }
        });

      });

      $('#exportExcels').on('click', function () {
 
         var data = JSON.parse(localStorage.getItem('devicedata'));
 
         data = excel.filterExportData(data, [
           'id',
           'names',
           'brand',
           'conid',
           'num',
           'roomnames',
           'facid',
           'factime',
           'proid',
           'supid',
           'arate'
         ]);
         data.unshift({
           id: "设备编号", names: '设备名称', brand: '品牌型号', conid: '设备状态编号', num: '设备数量',
           roomnames: '实验室名称', facid: '出厂编号', factime: '出厂日期', proid: '生产厂商编号', supid: '供应商编号', arate: '损耗率'
         });
 
         var timestart = Date.now();
         excel.exportExcel(data, '实验室设备损耗率报告' + '.xlsx', 'xlsx');
 
       }); 
    });

  </script>
</body>

</html>